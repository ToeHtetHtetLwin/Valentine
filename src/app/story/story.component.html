<div class="main-container min-h-screen bg-rose-50 flex flex-col items-center justify-center relative overflow-hidden p-6">
  
  <div *ngIf="answer === 'yes'" class="absolute inset-0 pointer-events-none z-0">
    <div class="heart-particle" style="left: 10%">â¤ï¸</div>
    <div class="heart-particle" style="left: 50%; animation-delay: 1s">ğŸ’–</div>
    <div class="heart-particle" style="left: 80%; animation-delay: 0.5s">ğŸŒ¸</div>
  </div>

  <div *ngIf="step === 1" class="text-center animate-in zoom-in z-10">
    <h1 class="text-3xl md:text-5xl font-extrabold text-rose-600 mb-20 drop-shadow-sm italic">You have a surprise! ğŸ’Œ</h1>
    <div class="relative mx-auto w-64 md:w-80 h-44 md:h-56 cursor-pointer" style="overflow: visible;" (click)="openEnvelope()">
      <div *ngIf="isOpen" class="absolute -top-40 left-0 right-0 flex justify-center animate-pop-up z-50 pointer-events-none">
        <img src="heart.gif" alt="Heart" class="w-48 md:w-56 h-auto drop-shadow-2xl">
      </div>
      <div class="relative w-full h-full bg-rose-400 rounded-b-xl shadow-2xl flex items-center justify-center z-20">
        <p *ngIf="!isOpen" class="text-white text-lg font-bold animate-pulse">TAP TO OPEN</p>
      </div>
      <div [ngClass]="{'flap-open': isOpen}" class="absolute top-0 left-0 w-full h-32 md:h-40 bg-rose-500 origin-bottom transition-transform duration-700 z-30 shadow-inner" style="clip-path: polygon(0 0, 100% 0, 50% 100%)"></div>
    </div>
  </div>

  <div *ngIf="step === 2" class="max-w-md w-full animate-in fade-in z-10 text-center">
    <h2 class="text-3xl font-serif font-bold text-rose-700 mb-10">Pick a flower for us ğŸ’</h2>
    <div class="flex gap-6 justify-center">
      <div (click)="selectFlower('Rose')" class="flower-card bg-white p-6 rounded-3xl shadow-xl cursor-pointer border-4 border-transparent hover:border-rose-400 transition-all">
        <div class="text-6xl mb-2">ğŸŒ¹</div>
        <p class="font-bold text-rose-600">Red Rose</p>
      </div>
      <div (click)="selectFlower('Daisy')" class="flower-card bg-white p-6 rounded-3xl shadow-xl cursor-pointer border-4 border-transparent hover:border-amber-400 transition-all">
        <div class="text-6xl mb-2">ğŸŒ¼</div>
        <p class="font-bold text-amber-500">Daisy</p>
      </div>
    </div>
  </div>

  <div *ngIf="step === 3" class="max-w-md w-full animate-in fade-in z-10 text-center">
    <div class="bg-white/80 backdrop-blur-md p-8 rounded-3xl shadow-2xl border-2 border-rose-100">
      <span class="text-rose-400 font-bold text-sm uppercase">Memory Lane #{{quizStep + 1}}</span>
      <h2 class="text-2xl font-bold text-rose-700 my-6">{{ quizQuestions[quizStep].q }}</h2>
      <div class="grid grid-cols-1 gap-3">
        <button *ngFor="let opt of quizQuestions[quizStep].options" (click)="checkQuiz(opt)" class="py-3 px-6 bg-white border-2 border-rose-100 text-rose-600 rounded-2xl font-bold hover:bg-rose-500 hover:text-white transition-all">{{ opt }}</button>
      </div>
    </div>
  </div>

  <div *ngIf="step === 4" class="max-w-md w-full animate-in zoom-in z-10 text-center">
    <img src="heart.gif" class="w-40 h-40 mx-auto mb-6">
    <h2 class="text-3xl md:text-4xl font-serif font-bold text-rose-700 mb-8 animate-bounce">Will you be my <br> Valentine? â¤ï¸</h2>
    <div class="flex flex-col sm:flex-row justify-center gap-4 px-10">
      <button (click)="onResponse('yes')" class="flex-1 px-8 py-4 bg-rose-500 text-white rounded-full font-bold text-xl shadow-lg hover:scale-110 transition-all">YES! ğŸ’–</button>
      <button (click)="onResponse('no')" class="flex-1 px-8 py-4 bg-gray-200 text-gray-500 rounded-full font-bold text-xl hover:bg-gray-300">No ğŸ¥º</button>
    </div>
  </div>

  <div *ngIf="step === 5" class="text-center animate-in zoom-in z-10">
    <h1 class="text-5xl font-extrabold text-rose-600 mb-4 animate-bounce">Yay! Forever! ğŸ¥‚</h1>
    <p class="text-rose-700 font-serif italic mb-6">You picked the {{selectedFlower}}!</p>
    
    <div class="grid grid-cols-2 gap-4 max-w-[320px] mx-auto my-6">
      <div *ngFor="let img of coupleImages; let i = index" [class]="'polaroid border-8 border-white shadow-md rotate-' + (i % 2 === 0 ? '-3' : '3')">
        <img [src]="img" class="w-full h-28 object-cover">
      </div>
    </div>

    <div class="typing-container text-rose-700 text-lg font-serif italic font-bold">
      <p class="animate-typing">You make every day feel like Valentine's Day. â¤ï¸</p>
    </div>
  </div>

  <div *ngIf="step === 6" class="max-w-md w-full animate-in zoom-in z-10 text-center">
    <div class="text-9xl mb-8 animate-shake">ğŸ˜­</div>
    <h2 class="text-4xl font-bold text-gray-700 mb-4">Oh no...</h2>
    <p class="text-gray-500 mb-8">My heart is broken into a million pieces! ğŸ’” Are you sure?</p>
    <button (click)="tryAgain()" class="px-8 py-4 bg-rose-500 text-white rounded-full font-bold text-xl shadow-lg hover:scale-110 transition-all">
      I was joking! Yes! ğŸ¥°
    </button>
  </div>

  <div *ngIf="isOpen" class="mt-auto pt-10 w-full animate-in fade-in z-10">
    <div class="text-center bg-white/30 backdrop-blur-sm p-4 rounded-t-3xl">
      <p class="text-rose-400 font-bold uppercase tracking-widest text-[10px] mb-4">Countdown to our Day</p>
      <div class="flex gap-2 justify-center">
        <div class="timer-box"><span>{{ countdownText().days }}</span><p>Days</p></div>
        <div class="timer-box"><span>{{ countdownText().hours }}</span><p>Hrs</p></div>
        <div class="timer-box"><span>{{ countdownText().minutes }}</span><p>Min</p></div>
        <div class="timer-box bg-rose-500 text-white animate-pulse">
          <span class="text-white">{{ countdownText().seconds }}</span><p class="text-rose-100">Sec</p>
        </div>
      </div>
    </div>
  </div>
</div>